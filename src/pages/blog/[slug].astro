---
import Base from '../../layouts/Base.astro';
import { posts } from '../../data/posts.js';

export const prerender = true;

export async function getStaticPaths() {
  return posts.map(post => ({
    params: { slug: post.href.replace('/blog/', '') },
    props: { post }
  }));
}

const { post } = Astro.props;
const canonicalUrl = `https://agencevoglans.fr${post.href}`;
const imageUrl = post.image || 'https://agencevoglans.fr/images/og-default.jpg';

// Maillage interne intelligent : trouver 4-5 articles connexes
function findRelatedPosts(currentPost: typeof post, allPosts: typeof posts) {
  const related = allPosts
    .filter(p => p.href !== currentPost.href)
    .map(p => {
      let score = 0;
      
      // Même catégorie : +3 points
      if (p.category === currentPost.category) score += 3;
      
      // Tags communs : +2 points par tag
      const commonTags = p.tags.filter(tag => currentPost.tags.includes(tag));
      score += commonTags.length * 2;
      
      // Mots-clés communs dans le titre : +1 point
      const currentWords = currentPost.title.toLowerCase().split(' ');
      const postWords = p.title.toLowerCase().split(' ');
      const commonWords = currentWords.filter(word => 
        word.length > 4 && postWords.includes(word)
      );
      score += commonWords.length;
      
      return { post: p, score };
    })
    .filter(item => item.score > 0)
    .sort((a, b) => b.score - a.score)
    .slice(0, 5)
    .map(item => item.post);
  
  return related;
}

const relatedPosts = findRelatedPosts(post, posts);

// FAQ selon la catégorie
function getFAQForCategory(category: string, firstTag: string) {
  const faqs: Record<string, Array<{ question: string; answer: string }>> = {
    "Estimation": [
      {
        question: "Combien coûte une estimation immobilière ?",
        answer: "Notre estimation immobilière est totalement gratuite et sans engagement. Un expert se déplace à votre domicile pour évaluer votre bien en tenant compte de toutes ses caractéristiques."
      },
      {
        question: "Combien de temps prend une estimation ?",
        answer: "L'estimation est réalisée sous 48h. La visite dure environ 30-45 minutes, puis vous recevez un rapport détaillé avec le prix de marché recommandé dans les 48 heures."
      },
      {
        question: "Quels documents faut-il préparer pour l'estimation ?",
        answer: "Préparez le titre de propriété, les diagnostics techniques si disponibles, les factures de travaux récents et les charges de copropriété. Ces documents aident à affiner l'estimation."
      },
      {
        question: `Comment est calculée la valeur d'un bien à ${firstTag} ?`,
        answer: `La valeur est calculée selon plusieurs critères : prix au m² dans le secteur de ${firstTag}, état général du bien, emplacement, prestations, et analyse comparative des ventes récentes similaires.`
      }
    ],
    "Vente": [
      {
        question: "Combien de temps faut-il pour vendre une maison ?",
        answer: "En moyenne, une maison bien estimée se vend en 60-90 jours en Savoie. Avec notre stratégie marketing optimisée et notre réseau d'acheteurs, nous réduisons souvent ce délai de 30-40%."
      },
      {
        question: "Quels sont les frais de vente pour le vendeur ?",
        answer: "Les principaux frais sont les honoraires d'agence (généralement 4-6% TTC du prix de vente), les diagnostics obligatoires (500-1500€) et éventuellement les frais de mainlevée d'hypothèque."
      },
      {
        question: "Dois-je faire des travaux avant de vendre ?",
        answer: "Pas nécessairement. De gros travaux ne sont souvent pas rentables. Privilégiez un rafraîchissement (peinture, nettoyage professionnel) et des réparations mineures qui ont un excellent retour sur investissement."
      },
      {
        question: `Quel est le meilleur moment pour vendre à ${firstTag} ?`,
        answer: `Le printemps (mars-juin) est idéal à ${firstTag} avec +40% d'activité. Évitez juillet-août et décembre-janvier. Le marché est dynamique de février à octobre.`
      }
    ],
    "Marché immobilier": [
      {
        question: "Le marché immobilier en Savoie est-il dynamique ?",
        answer: "Oui, très dynamique. La Savoie bénéficie d'une forte attractivité grâce au lac du Bourget, la proximité de Chambéry/Aix-les-Bains, et la qualité de vie. La demande dépasse régulièrement l'offre."
      },
      {
        question: "Les prix de l'immobilier augmentent-ils ?",
        answer: "Les prix en Savoie ont augmenté de 3-5% par an ces dernières années. Certains secteurs recherchés comme le bord du lac connaissent des hausses plus importantes (6-8% annuels)."
      },
      {
        question: `Quelle est l'évolution des prix à ${firstTag} ?`,
        answer: `À ${firstTag}, les prix suivent la tendance régionale avec une croissance stable. Les biens bien situés (centre, commodités, transports) se valorisent particulièrement bien.`
      },
      {
        question: "Faut-il acheter ou attendre une baisse des prix ?",
        answer: "Attendre une baisse en Savoie est risqué. Le marché est porté par une demande structurelle forte. L'adage 'le meilleur moment était hier, le second meilleur est aujourd'hui' s'applique ici."
      }
    ],
    "Investissement": [
      {
        question: "Quel rendement locatif peut-on espérer en Savoie ?",
        answer: "Le rendement locatif moyen en Savoie est de 4-5% brut pour du longue durée, et 6-8% pour de la location meublée/saisonnière dans les zones touristiques."
      },
      {
        question: "Quels dispositifs de défiscalisation sont disponibles ?",
        answer: "Plusieurs dispositifs existent : Pinel (réduction d'impôt), LMNP (amortissement du bien), Denormandie (ancien avec travaux), ou le régime micro-BIC pour les meublés."
      },
      {
        question: "Faut-il un apport pour investir dans l'immobilier ?",
        answer: "Un apport de 10-20% est recommandé mais pas toujours obligatoire. Avec un bon dossier et un projet solide, certaines banques financent jusqu'à 110% (frais de notaire inclus)."
      },
      {
        question: `Pourquoi investir à ${firstTag} ?`,
        answer: `${firstTag} offre un excellent rapport qualité/prix, une demande locative soutenue, et un potentiel de plus-value intéressant grâce à l'attractivité croissante de la Savoie.`
      }
    ],
    "Expertise": [
      {
        question: "Pourquoi choisir une agence locale plutôt qu'une grande franchise ?",
        answer: "Une agence locale connaît intimement son territoire : prix réels, acheteurs du secteur, spécificités administratives. Cette expertise se traduit par des ventes plus rapides et mieux valorisées."
      },
      {
        question: "Comment une agence immobilière valorise-t-elle mon bien ?",
        answer: "Nous créons des annonces attractives avec photos pro, vidéos, visites virtuelles. Notre réseau d'acheteurs, présence digitale optimisée et stratégie marketing garantissent une visibilité maximale."
      },
      {
        question: "Quelle est la différence entre mandat simple et exclusif ?",
        answer: "Le mandat exclusif vous garantit un investissement marketing maximal de notre part. En contrepartie, nous sommes votre unique interlocuteur, ce qui simplifie la gestion et accélère la vente."
      },
      {
        question: "Puis-je vendre sans agence ?",
        answer: "Techniquement oui, mais 85% des ventes passent par une agence. Le gain de temps, la sécurité juridique, l'accès aux acheteurs qualifiés et la négociation optimisée justifient largement les honoraires."
      }
    ]
  };
  
  // Catégories par défaut
  const defaultFAQ = [
    {
      question: "Comment se déroule une transaction immobilière en Savoie ?",
      answer: "Une transaction suit plusieurs étapes : estimation, mise en vente, visites, offre d'achat, compromis de vente (sous 7-15 jours), délai de rétractation (10 jours), puis signature définitive chez le notaire (2-3 mois après le compromis)."
    },
    {
      question: `Quels sont les avantages du secteur ${firstTag} ?`,
      answer: `Le secteur de ${firstTag} bénéficie d'une excellente qualité de vie en Savoie, avec un cadre naturel préservé, des commodités accessibles et une bonne desserte. C'est un secteur recherché par les familles et les actifs.`
    },
    {
      question: "Comment préparer la vente de mon bien immobilier ?",
      answer: "Commencez par un désencombrement (50% des objets), un nettoyage professionnel, des petites réparations et une neutralisation de la décoration. Ces actions simples peuvent augmenter le prix de vente de 5-10%."
    },
    {
      question: "Quels diagnostics immobiliers sont obligatoires ?",
      answer: "Les diagnostics obligatoires incluent : DPE, amiante, plomb, termites (zones concernées), gaz et électricité (si +15 ans), assainissement, risques naturels (ERNMT) et loi Carrez/Boutin selon le type de bien."
    }
  ];
  
  return faqs[category] || defaultFAQ;
}

const articleFAQ = getFAQForCategory(post.category, post.tags[0] || 'Savoie');

// FAQ Schema pour Featured Snippets
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": articleFAQ.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
};

// Fonction de parsing de date française vers ISO
function parseFrenchDate(frenchDate: string): string {
  const months: Record<string, string> = {
    'janvier': '01', 'février': '02', 'mars': '03', 'avril': '04',
    'mai': '05', 'juin': '06', 'juillet': '07', 'août': '08',
    'septembre': '09', 'octobre': '10', 'novembre': '11', 'décembre': '12'
  };
  
  const match = frenchDate.match(/(\d+)\s+(\w+)\s+(\d{4})/);
  if (match) {
    const [, day, month, year] = match;
    const monthNum = months[month.toLowerCase()] || '01';
    return `${year}-${monthNum}-${day.padStart(2, '0')}T10:00:00+02:00`;
  }
  // Fallback : date actuelle
  return new Date().toISOString();
}

const isoDate = parseFrenchDate(post.date);

// Schema.org JSON-LD pour Article
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": post.title,
  "description": post.description,
  "image": imageUrl,
  "datePublished": isoDate,
  "dateModified": isoDate,
  "author": {
    "@type": "Organization",
    "name": "L'Agence de Voglans",
    "url": "https://agencevoglans.fr"
  },
  "publisher": {
    "@type": "Organization",
    "name": "L'Agence de Voglans",
    "logo": {
      "@type": "ImageObject",
      "url": "https://agencevoglans.fr/logo.png"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": canonicalUrl
  },
  "keywords": post.tags.join(', '),
  "wordCount": 800,
  "timeRequired": post.readingTime,
  "inLanguage": "fr-FR"
};

// Breadcrumb Schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Accueil",
      "item": "https://agencevoglans.fr"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "https://agencevoglans.fr/blog"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": post.title,
      "item": canonicalUrl
    }
  ]
};
---

<Base title={post.title} description={post.description}>
  <!-- SEO Meta Tags -->
  <Fragment slot="head">
    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalUrl} />
    
    <!-- Meta Keywords -->
    <meta name="keywords" content={post.tags.join(', ')} />
    
    <!-- Author -->
    <meta name="author" content="L'Agence de Voglans" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={post.title} />
    <meta property="og:description" content={post.description} />
    <meta property="og:image" content={imageUrl} />
    <meta property="og:site_name" content="L'Agence de Voglans" />
    <meta property="article:published_time" content={isoDate} />
    <meta property="article:author" content="L'Agence de Voglans" />
    <meta property="article:section" content={post.category} />
    {post.tags.map(tag => <meta property="article:tag" content={tag} />)}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalUrl} />
    <meta name="twitter:title" content={post.title} />
    <meta name="twitter:description" content={post.description} />
    <meta name="twitter:image" content={imageUrl} />
    
    <!-- JSON-LD Schema -->
    <script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
    
    <!-- Preconnect pour optimiser le chargement des images Unsplash -->
    <link rel="preconnect" href="https://images.unsplash.com" />
    <link rel="dns-prefetch" href="https://images.unsplash.com" />
  </Fragment>
  <main class="min-h-screen bg-gray-50 py-12">
    <article class="max-w-4xl mx-auto px-4">
      <!-- Breadcrumb -->
      <nav aria-label="Breadcrumb" class="mb-6">
        <ol class="flex items-center gap-2 text-sm text-gray-600">
          <li>
            <a href="/" class="hover:text-blue-600 transition">Accueil</a>
          </li>
          <li>/</li>
          <li>
            <a href="/blog" class="hover:text-blue-600 transition">Blog</a>
          </li>
          <li>/</li>
          <li class="text-gray-900 font-medium">{post.category}</li>
        </ol>
      </nav>
      
      <!-- Header -->
      <header class="mb-8">
        <div class="mb-4">
          <span class="inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
            {post.category}
          </span>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
          {post.title}
        </h1>
        <div class="flex items-center gap-4 text-gray-600">
          <time datetime={isoDate}>{post.date}</time>
          <span>•</span>
          <span>{post.readingTime}</span>
        </div>
      </header>

      <!-- Image -->
      <div class="mb-8 rounded-lg overflow-hidden">
        <img 
          src={post.image} 
          alt={post.title}
          width="800"
          height="400"
          loading="eager"
          fetchpriority="high"
          class="w-full h-96 object-cover"
        />
      </div>

      <!-- Description -->
      <div class="prose prose-lg max-w-none mb-8">
        <p class="text-xl text-gray-700 leading-relaxed">
          {post.description}
        </p>
      </div>

      <!-- Contenu principal dynamique -->
      <div class="prose prose-lg max-w-none mb-12">
        {post.category === "Estimation" && (
          <>
            <h2>Estimation immobilière précise et gratuite</h2>
            <p>
              Vous souhaitez connaître la valeur de votre bien immobilier ? Notre expertise locale nous permet 
              d'évaluer précisément votre propriété en tenant compte des spécificités du marché de {post.tags[0]}.
            </p>
            
            <h2>Les critères d'estimation que nous analysons</h2>
            <ul>
              <li><strong>L'emplacement géographique</strong> : proximité des commodités, transports, écoles</li>
              <li><strong>L'état général du bien</strong> : rénovations, équipements, performance énergétique</li>
              <li><strong>Le marché local</strong> : prix au m², demande, temps de vente moyen</li>
              <li><strong>Les caractéristiques uniques</strong> : vue, terrain, exposition, cachet</li>
            </ul>

            <h2>Notre méthodologie d'estimation</h2>
            <p>
              Nous utilisons une approche multicritère qui combine l'analyse des ventes récentes dans votre secteur, 
              l'étude comparative du marché et notre connaissance approfondie du territoire savoyard. Cette méthode 
              nous permet de vous proposer une estimation juste et réaliste, essentielle pour une vente réussie.
            </p>

            <h2>Pourquoi une estimation professionnelle est essentielle</h2>
            <p>
              Un bien sur-évalué reste longtemps sur le marché et finit par se dévaloriser. Un bien sous-évalué 
              vous fait perdre de l'argent. Notre estimation gratuite vous donne le juste prix pour vendre 
              rapidement et au meilleur tarif.
            </p>
          </>
        )}

        {post.category === "Vente" && (
          <>
            <h2>Stratégie de vente optimisée</h2>
            <p>
              Vendre un bien immobilier nécessite une stratégie adaptée au marché local. En Savoie, et particulièrement 
              concernant {post.tags[0]}, nous maîtrisons les spécificités qui feront la différence entre une vente 
              rapide au bon prix et un bien qui stagne sur le marché.
            </p>

            <h2>Les étapes clés d'une vente réussie</h2>
            <ul>
              <li><strong>Estimation précise</strong> : définir le juste prix selon le marché actuel</li>
              <li><strong>Préparation du bien</strong> : mise en valeur, home staging si nécessaire</li>
              <li><strong>Marketing ciblé</strong> : photos pro, annonces optimisées, diffusion large</li>
              <li><strong>Visites qualifiées</strong> : sélection d'acheteurs sérieux et motivés</li>
              <li><strong>Négociation</strong> : obtenir le meilleur prix dans les meilleurs délais</li>
              <li><strong>Accompagnement juridique</strong> : sécurisation de la transaction</li>
            </ul>

            <h2>Comment nous valorisons votre bien</h2>
            <p>
              Notre approche combine expertise technique et marketing digital. Nous créons des annonces attractives 
              avec photos professionnelles, vidéos et visites virtuelles. Notre réseau d'acheteurs qualifiés et 
              notre présence digitale optimisée garantissent une visibilité maximale à votre bien.
            </p>

            <h2>Les erreurs à éviter lors de la vente</h2>
            <ul>
              <li>Fixer un prix trop élevé qui décourage les acheteurs</li>
              <li>Négliger la présentation du bien lors des visites</li>
              <li>Manquer de réactivité face aux demandes</li>
              <li>Accepter des offres non sécurisées</li>
            </ul>
          </>
        )}

        {post.category === "Marché immobilier" && (
          <>
            <h2>Analyse du marché immobilier local</h2>
            <p>
              Le marché immobilier évolue constamment. Comprendre les tendances actuelles concernant {post.tags[0]} 
              est essentiel pour prendre les bonnes décisions, que vous soyez vendeur, acheteur ou investisseur.
            </p>

            <h2>Les tendances du marché en Savoie</h2>
            <ul>
              <li><strong>Évolution des prix</strong> : analyse des variations sur les 12 derniers mois</li>
              <li><strong>Délais de vente</strong> : temps moyen entre mise en vente et signature</li>
              <li><strong>Profil des acheteurs</strong> : primo-accédants, investisseurs, résidences secondaires</li>
              <li><strong>Types de biens recherchés</strong> : maisons, appartements, terrains</li>
            </ul>

            <h2>Facteurs influençant le marché local</h2>
            <p>
              Plusieurs éléments impactent le marché immobilier en Savoie : l'attractivité touristique du lac du Bourget, 
              la proximité de Chambéry et d'Aix-les-Bains, le développement des infrastructures de transport, et la 
              qualité de vie reconnue de la région. Ces atouts maintiennent une demande soutenue.
            </p>

            <h2>Prévisions et perspectives</h2>
            <p>
              Le marché savoyard reste dynamique grâce à son attractivité constante. La combinaison entre cadre naturel 
              exceptionnel, proximité urbaine et offre culturelle continue d'attirer de nouveaux habitants et 
              investisseurs. C'est le moment idéal pour concrétiser votre projet immobilier.
            </p>
          </>
        )}

        {post.category === "Investissement" && (
          <>
            <h2>Pourquoi investir dans l'immobilier en Savoie ?</h2>
            <p>
              La Savoie offre des opportunités d'investissement attractives. Que ce soit pour de la location longue durée, 
              saisonnière ou de la résidence de tourisme, le marché de {post.tags[0]} présente des atouts indéniables 
              pour les investisseurs avisés.
            </p>

            <h2>Les avantages d'un investissement locatif</h2>
            <ul>
              <li><strong>Rendement attractif</strong> : rentabilité locative intéressante sur le bassin chambérien</li>
              <li><strong>Fiscalité avantageuse</strong> : dispositifs Pinel, LMNP, défiscalisation</li>
              <li><strong>Plus-value à long terme</strong> : marché immobilier stable et valorisant</li>
              <li><strong>Demande locative soutenue</strong> : étudiants, actifs, touristes</li>
            </ul>

            <h2>Comment sélectionner le bon bien d'investissement</h2>
            <p>
              Un investissement réussi repose sur trois piliers : l'emplacement (proximité transports, commerces, écoles), 
              le prix d'acquisition (potentiel de négociation, travaux prévisibles) et la rentabilité (loyers pratiqués, 
              charges, fiscalité). Notre expertise locale vous guide vers les meilleures opportunités.
            </p>

            <h2>Stratégies d'investissement selon votre profil</h2>
            <ul>
              <li><strong>Investisseur débutant</strong> : studio ou T2 avec rendement immédiat</li>
              <li><strong>Constitution de patrimoine</strong> : maison à rénover avec potentiel</li>
              <li><strong>Optimisation fiscale</strong> : dispositifs de défiscalisation adaptés</li>
              <li><strong>Revenus complémentaires</strong> : location meublée touristique</li>
            </ul>
          </>
        )}

        {post.category === "Expertise" && (
          <>
            <h2>Notre expertise au service de votre projet</h2>
            <p>
              L'immobilier en Savoie a ses spécificités. Notre connaissance approfondie du marché local concernant 
              {post.tags[0]} nous permet de vous accompagner efficacement, quelle que soit votre situation.
            </p>

            <h2>Une connaissance territoriale unique</h2>
            <p>
              Chaque commune, chaque quartier a ses particularités. Les Bauges ne se vendent pas comme le bord du lac, 
              le centre de Chambéry diffère des villages périphériques. Cette expertise fine du territoire fait la 
              différence entre une transaction réussie et une opportunité manquée.
            </p>

            <h2>Un accompagnement personnalisé</h2>
            <ul>
              <li><strong>Écoute de vos besoins</strong> : comprendre vos objectifs et contraintes</li>
              <li><strong>Conseil stratégique</strong> : vous orienter vers les meilleures décisions</li>
              <li><strong>Transparence totale</strong> : information claire sur chaque étape</li>
              <li><strong>Disponibilité</strong> : réactivité et suivi régulier de votre dossier</li>
            </ul>

            <h2>Les garanties d'une agence locale</h2>
            <p>
              Contrairement aux plateformes en ligne ou aux grandes franchises, nous sommes implantés localement. 
              Nous connaissons personnellement les quartiers, les prix réels du marché, les spécificités administratives 
              locales et disposons d'un réseau d'acheteurs qualifiés déjà intéressés par votre secteur.
            </p>
          </>
        )}

        {(post.category === "Achat" || post.category === "Conseils" || post.category === "Guide local" || post.category === "Fiscalité" || post.category === "Témoignage") && (
          <>
            <h2>Comprendre le marché immobilier local</h2>
            <p>
              Chaque décision immobilière nécessite une bonne compréhension du contexte local. En Savoie, 
              particulièrement concernant {post.tags[0]}, plusieurs facteurs influencent le marché et méritent 
              votre attention.
            </p>

            <h2>Les spécificités du territoire savoyard</h2>
            <ul>
              <li><strong>Cadre de vie exceptionnel</strong> : entre lac et montagnes, qualité de vie reconnue</li>
              <li><strong>Accessibilité</strong> : proximité Lyon, Genève, Annecy via autoroutes et TGV</li>
              <li><strong>Dynamisme économique</strong> : bassins d'emploi de Chambéry et Aix-les-Bains</li>
              <li><strong>Offre culturelle et sportive</strong> : activités toute l'année</li>
            </ul>

            <h2>Notre accompagnement sur mesure</h2>
            <p>
              Que vous achetiez votre résidence principale, investissiez dans la pierre ou vendiez votre bien, 
              nous vous accompagnons avec une approche personnalisée. Notre expertise locale et notre connaissance 
              du marché sont vos meilleurs atouts pour réussir votre projet immobilier.
            </p>

            <h2>Les avantages de travailler avec une agence locale</h2>
            <p>
              Une agence implantée localement connaît les particularités de chaque secteur, les prix réels pratiqués, 
              les projets d'aménagement à venir et dispose d'un réseau établi. Cette proximité se traduit par un service 
              plus efficace et des résultats concrets pour votre projet.
            </p>
          </>
        )}
      </div>

      <!-- FAQ Section -->
      <div class="my-12 bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-8 border border-purple-100">
        <div class="flex items-center gap-3 mb-6">
          <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <h2 class="text-2xl font-bold text-gray-900">Questions fréquentes</h2>
        </div>
        
        <div class="space-y-4">
          {articleFAQ.map((faq, index) => (
            <details class="group bg-white rounded-xl border border-purple-100 overflow-hidden hover:border-purple-300 transition">
              <summary class="flex items-center justify-between p-5 cursor-pointer list-none">
                <h3 class="text-lg font-semibold text-gray-900 flex-1 pr-4">
                  {faq.question}
                </h3>
                <svg 
                  class="w-5 h-5 text-purple-600 transform group-open:rotate-180 transition-transform duration-200 flex-shrink-0" 
                  fill="none" 
                  stroke="currentColor" 
                  viewBox="0 0 24 24"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </summary>
              <div class="px-5 pb-5 pt-2 text-gray-700 leading-relaxed border-t border-purple-50">
                {faq.answer}
              </div>
            </details>
          ))}
        </div>

        <div class="mt-6 p-4 bg-white/60 backdrop-blur rounded-lg border border-purple-100">
          <p class="text-sm text-gray-600 flex items-start gap-2">
            <svg class="w-5 h-5 text-purple-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span>
              <strong>Vous avez d'autres questions ?</strong> Notre équipe d'experts est à votre disposition pour répondre à toutes vos interrogations. 
              <a href="/contact" class="text-purple-600 font-semibold hover:text-purple-700 underline">Contactez-nous</a>
            </span>
          </p>
        </div>
      </div>

      <!-- Articles connexes (Maillage interne) -->
      {relatedPosts.length > 0 && (
        <div class="my-12 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 border border-blue-100">
          <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
            Articles connexes qui pourraient vous intéresser
          </h2>
          <div class="grid md:grid-cols-2 gap-4">
            {relatedPosts.map((relatedPost: typeof post) => (
              <a 
                href={relatedPost.href}
                class="group bg-white rounded-xl p-5 border border-blue-100 hover:border-blue-300 hover:shadow-lg transition-all duration-300"
              >
                <div class="flex items-start gap-4">
                  <div class="flex-shrink-0 w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                  </div>
                  <div class="flex-1">
                    <div class="text-xs font-semibold text-blue-600 mb-2">{relatedPost.category}</div>
                    <h3 class="text-base font-semibold text-gray-900 group-hover:text-blue-600 transition line-clamp-2">
                      {relatedPost.title}
                    </h3>
                    <div class="flex items-center gap-2 mt-2 text-xs text-gray-500">
                      <span>{relatedPost.readingTime}</span>
                      <span>•</span>
                      <span class="flex items-center gap-1">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                        Lire
                      </span>
                    </div>
                  </div>
                </div>
              </a>
            ))}
          </div>
        </div>
      )}

      <!-- Call to action -->
      <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg">
        <h3 class="text-2xl font-bold text-gray-900 mb-4">
          Besoin d'une estimation gratuite ?
        </h3>
        <p class="text-gray-700 mb-4">
          Nos experts vous proposent une estimation précise et gratuite de votre bien 
          sous 48h. Contactez-nous dès maintenant !
        </p>
        <div class="flex gap-4">
          <a 
            href="/contact" 
            class="inline-block px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition"
          >
            Demander une estimation
          </a>
          <a 
            href="/blog" 
            class="inline-block px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition"
          >
            Retour au blog
          </a>
        </div>
      </div>

      <!-- Tags -->
      <div class="mt-8">
        <div class="flex flex-wrap gap-2">
          {post.tags.map((tag: string) => (
            <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm">
              {tag}
            </span>
          ))}
        </div>
      </div>
    </article>
  </main>
</Base>

<style>
  .prose h2 {
    @apply text-2xl font-bold text-gray-900 mt-8 mb-4;
  }
  
  .prose h3 {
    @apply text-xl font-bold text-gray-900 mt-6 mb-3;
  }
  
  .prose p {
    @apply text-gray-700 leading-relaxed mb-4;
  }
  
  .prose ul {
    @apply list-disc list-inside space-y-2 text-gray-700 mb-4;
  }
  
  .prose li {
    @apply ml-4;
  }
</style>
